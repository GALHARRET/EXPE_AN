[
  {
    "objectID": "LME.html",
    "href": "LME.html",
    "title": "Introduction",
    "section": "",
    "text": "options(knitr.kable.NA = '')\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(dplyr)\nlibrary(readxl)\nlibrary(lmerTest)\nlibrary(kableExtra)\nlibrary(gtsummary)\noptions(contrasts=c(\"contr.sum\",\"contr.sum\"))\ndf &lt;- read_excel(\"data1.xlsx\")"
  },
  {
    "objectID": "LME.html#données-temporelles",
    "href": "LME.html#données-temporelles",
    "title": "Introduction",
    "section": "Données temporelles",
    "text": "Données temporelles\nLes mesures longitudinales et répétées sont des données temporelles. Elles sont très utilisées en expérimentation animale.\nUn cas classique est d’étudier l’effet d’un traitement, d’un régime sur des animaux au cours du temps."
  },
  {
    "objectID": "LME.html#modélisation-statistique-de-données-indépendantes",
    "href": "LME.html#modélisation-statistique-de-données-indépendantes",
    "title": "Introduction",
    "section": "Modélisation statistique de données indépendantes",
    "text": "Modélisation statistique de données indépendantes\nDans toute la suite la variable que l’on souhaite expliquer est notée \\(Y\\), le traitement sera noté \\(A\\) et les covariables au traitement seront notées \\(X\\) (dans l’écriture on se limitera à une seule covariable mais plusieurs peuvent être considérées).\nDans ce cours : \\(Y\\) est une variable continue, nous verrons dans un autre cours le cas où la variable est qualitative.\nRevenons aux cas d’observations indépendantes : on veut étudier l’effet du traitement \\(A\\) sur \\(Y\\) en contrôlant la covariable \\(X\\). On a deux situations possibles :\n\n\\(A\\) est une variable continue (e.g. dose de médicament) et dans ce cas on écrit :\n\n\\[\nY_{i}=\\mu+\\alpha A_i+\\beta X_{i}+\\varepsilon_{i}\n\\]\n\\(Y_{ij}\\) valeur pour l’animal \\(i\\) et le niveau de traitement \\(j\\), \\(X_{ij}\\) étant la valeur de la covariable \\(X\\).\nEt alors on teste l’effet de \\(A\\) en testant \\(H_0:\\alpha=0.\\)\n\n\\(A\\) est une variable qualitative (e.g. un régime) qui possède différents niveaux (on note \\(a\\) le nombre de niveaux de \\(A\\)). Dans ce cas on écrit :\n\n\\[\nY_{ij}=\\mu+\\alpha_j +\\beta X_{ij}+\\varepsilon_{ij}\n\\] \\(Y_{ij}\\) valeur pour l’animal \\(i\\) et le niveau de traitement \\(j\\), \\(X_{ij}\\) étant la valeur de la covariable \\(X\\).\nPour tester l’effet du traitement \\(A\\) on va tester \\(H_0:\\alpha_1=...=\\alpha_a=0.\\)\nDans les deux cas \\(\\mu\\) représente l’intercept du modèle.\nDans cette modélisation les résidus sont supposés indépendants (c’est à dire au moins non corrélés). Ceci est plausible car il n’y a, a priori, aucun rapport entre les différents individus."
  },
  {
    "objectID": "LME.html#exemple-issu-de-données-de-lécole",
    "href": "LME.html#exemple-issu-de-données-de-lécole",
    "title": "Introduction",
    "section": "Exemple issu de données de l’école",
    "text": "Exemple issu de données de l’école\nCette étude a pour objectif de contrôler l’effet au cours du temps de 4 régimes alimentaires sur les paramètres biochimiques liés au contrôle de l’obésité.\nOn constitue 4 groupes de 6 rats : un groupe contrôle (CC), un groupe recevant un régime enrichi en lipide (LL), un régime enrichi en fructose (FF) et un enrichi en lipide et fructose (LF).\nLes variables contrôlées sont les suivantes :\n\nBody Weigth ( poids corporel),\nMasse grasse corporelle,\nGlycémie,\nInsulinémie,\nTaux de cholestérol,\nTaux de triglycérides,\nNon Esterified Fatty Acid.\n\nToutes les données sont mesurées au bout d’une semaine (Week1) puis de 11 (Week11). Le plan d’expérience peut être résumé par la figure suivante :\n\n\n\nfigure 1\n\n\nUn extrait des données recueillies :\nOn étudie\n\ndf &lt;- read_excel(\"~/Dropbox/ONIRIS/cours/cours_VETO/EXPE_ANIMALE/data1.xlsx\")\ndf$Groups&lt;-factor(df$Groups,levels=c(\"CC\",\"LL\",\"FF\",\"LF\"),labels=c(\"CC\",\"LL\",\"FF\",\"LF\"))\ndf$Time&lt;-factor(df$Time,levels=c(\"Week 1\",\"Week 11\"))\nkable(head(df),digits=2)\n\n\n\n\nRats\nGroups\nTime\nBW\nbody fat\nGlycemia\nInsulinemia\nCholesterol\nTG\nNEFA\n\n\n\n\n1\nCC\nWeek 1\n385.4\n44.58\n5.13\n2.41\n1.31\n1.83\n0.54\n\n\n2\nCC\nWeek 1\n392.4\n23.70\n5.45\n2.23\n2.02\n1.34\n0.51\n\n\n3\nCC\nWeek 1\n406.1\n36.19\n5.52\n2.36\n1.82\n1.82\n0.28\n\n\n4\nCC\nWeek 1\n421.6\n36.30\n5.46\n2.17\n1.69\n2.41\n0.65\n\n\n5\nCC\nWeek 1\n385.9\n43.24\n5.52\n2.34\n2.03\n2.15\n0.23\n\n\n6\nCC\nWeek 1\n412.9\n29.37\n5.95\n2.50\n1.95\n1.77\n0.51\n\n\n\n\n\n\n\nQuestion : Les données sont elles dépendantes ou indépendantes ? Pourquoi ?"
  },
  {
    "objectID": "LME.html#etude-de-leffet-régime",
    "href": "LME.html#etude-de-leffet-régime",
    "title": "Introduction",
    "section": "Etude de l’effet régime",
    "text": "Etude de l’effet régime\nOn commence par faire une représentation graphique de NEFA en fonction du groupe\n\nggplot(df1,aes(x=Groups,y=NEFA))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"NEFA en fonction du régime\")\n\n\n\n\nQuestion Le regime semble t’il avoir un effet sur NEFA ? Quel groupe a la plus grande dispersion ? A combien d’observations correspondent les boxplots\n\ndf1$Groups&lt;-as.factor(df1$Groups)\nrelevel(df1$Groups,ref=\"CC\")\n\n [1] CC CC CC CC CC CC LL LL LL LL LL LL FF FF FF FF FF FF LF LF LF LF LF LF\nLevels: CC FF LF LL\n\nmodLin&lt;-lm(NEFA~Groups,data=df1)\nanova(modLin) %&gt;% kable(digits=3)\n\n\n\n\n\nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\n\nGroups\n3\n0.018\n0.006\n0.898\n0.459\n\n\nResiduals\n20\n0.134\n0.007\n\n\n\n\n\n\n\n\nsummary(modLin)\n\n\nCall:\nlm(formula = NEFA ~ Groups, data = df1)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.12514 -0.04834 -0.00613  0.05089  0.16461 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.405113   0.016709  24.245 2.66e-16 ***\nGroups1     -0.025634   0.028941  -0.886    0.386    \nGroups2      0.007566   0.028941   0.261    0.796    \nGroups3      0.041680   0.028941   1.440    0.165    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.08186 on 20 degrees of freedom\nMultiple R-squared:  0.1187,    Adjusted R-squared:  -0.01346 \nF-statistic: 0.8981 on 3 and 20 DF,  p-value: 0.4594"
  },
  {
    "objectID": "LME.html#modèle-à-intercept-aléatoire",
    "href": "LME.html#modèle-à-intercept-aléatoire",
    "title": "Introduction",
    "section": "Modèle à intercept aléatoire",
    "text": "Modèle à intercept aléatoire\n\nggplot(df,aes(x=Groups,y=NEFA,color=Time))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"NEFA en fonction du régime\")\n\n\n\n\nDans R pour définir un modèle à effets mixtes on va utiliser le package lmerTest.\nLa figure ci-dessus nous donne la différence de NEFA pour chaque rat du groupe CC (contrôle) en fonction de la semaine considérée.\nD’un point de vue modélisation on va écrire :\n\\[\nNEFA_{ij}=\\mu+\\alpha_i+\\beta_{j}+\\varepsilon_{ij},\n\\] où \\(i\\) est le numéro du rat (de 1 à 6) et \\(j\\) la semaine considérée (1 ou 11).\nOn obtient les résultats suivants (estimations avec la fonction lm de R).\n\ndfCC&lt;-as.data.frame(df%&gt;% filter(Groups==\"CC\"))\ndfCC$Rats&lt;-factor(dfCC$Rats)\ndfCC$Time&lt;-factor(dfCC$Time,levels=c(\"Week 11\",\"Week 1\"))\nrelevel(dfCC$Time,ref=\"Week 1\")\n\n [1] Week 1  Week 1  Week 1  Week 1  Week 1  Week 1  Week 11 Week 11 Week 11\n[10] Week 11 Week 11 Week 11\nLevels: Week 1 Week 11\n\nmod&lt;-lm(NEFA~Time+Rats,data=dfCC)\nsummary(mod)\n\n\nCall:\nlm(formula = NEFA ~ Time + Rats, data = dfCC)\n\nResiduals:\n       1        2        3        4        5        6        7        8 \n 0.11125  0.01505 -0.10442  0.12214 -0.09833 -0.04568 -0.11125 -0.01505 \n       9       10       11       12 \n 0.10442 -0.12214  0.09833  0.04568 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.37948    0.04090   9.279 0.000245 ***\nTime1       -0.07570    0.04090  -1.851 0.123413    \nRats1       -0.02154    0.09145  -0.235 0.823165    \nRats2        0.03709    0.09145   0.406 0.701859    \nRats3       -0.06620    0.09145  -0.724 0.501559    \nRats4        0.07309    0.09145   0.799 0.460437    \nRats5       -0.12514    0.09145  -1.368 0.229483    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1417 on 5 degrees of freedom\nMultiple R-squared:  0.5898,    Adjusted R-squared:  0.09756 \nF-statistic: 1.198 on 6 and 5 DF,  p-value: 0.4307\n\nplot(as.numeric(dfCC$Time),dfCC$NEFA,pch=20,col=dfCC$Rats,ylim=c(0,.6),\n     main=\"Groupe CC\",ylab=\"NEFA\")\nabline(a=coef(mod)[1],b=coef(mod)[2])\nfor(i in 1:5){\n  abline(a=coef(mod)[1]+coef(mod)[2+i],b=coef(mod)[2],col=(1+i))\n}\n\n\n\n\nEn soi, les résultats individuels des rats n’ont aucun intérêt, on veut seulement “neutraliser” les différences de NEFA qui sont associées à ces rats. Pour ce faire plutôt que de considérer un effet fixe par rat on va utiliser un effet aléatoire qui résumera l’effet “rat”.\nLe modèle précédent est toujours le même sauf que\n\\[\n\\alpha_i \\sim \\mathcal N(0,\\sigma^2_\\alpha)\n\\] avec \\(\\alpha_i,\\varepsilon_{ij}\\) indépendantes. On résume ainsi les différents coefficients \\(\\alpha_i\\) à une seule variance.\n\nmodE&lt;-lmer(NEFA~Time+(1|Rats),data=dfCC)\nsummary(modE)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: NEFA ~ Time + (1 | Rats)\n   Data: dfCC\n\nREML criterion at convergence: -7.1\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.6849 -0.5277  0.2272  0.4915  1.4720 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Rats     (Intercept) 0.00000  0.0000  \n Residual             0.01759  0.1326  \nNumber of obs: 12, groups:  Rats, 6\n\nFixed effects:\n            Estimate Std. Error       df t value Pr(&gt;|t|)    \n(Intercept)  0.37948    0.03829 10.00000   9.912 1.72e-06 ***\nTime1       -0.07570    0.03829 10.00000  -1.977   0.0762 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n      (Intr)\nTime1 0.000 \noptimizer (nloptwrap) convergence code: 0 (OK)\nboundary (singular) fit: see help('isSingular')\n\n\nOn constate que cela ne change pas l’estimation de l’effet semaine (appelé effet fixe)."
  },
  {
    "objectID": "LME.html#retour-au-modèle-global",
    "href": "LME.html#retour-au-modèle-global",
    "title": "Introduction",
    "section": "Retour au modèle global",
    "text": "Retour au modèle global\n\\[\nNEFA_{ijk}=\\mu+\\alpha_i+\\beta_{j}+\\gamma_{k}+(\\beta\\gamma)_{jk}+\\varepsilon_{ijk},\n\\] où \\(i\\) est le numéro du rat, \\(j\\) le numéro de la semaine et \\(k\\) le numéro du groupe. On a donc trois effets fixes : semaine, groupe et leur interaction. Un effet aléatoire sur l’effet individuel rat.\n\nRegLin&lt;-lm(NEFA~Groups*Time,data=df)\nsummary(RegLin)\n\n\nCall:\nlm(formula = NEFA ~ Groups * Time, data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.223468 -0.052560 -0.003011  0.056438  0.217414 \n\nCoefficients:\n               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    0.405113   0.016595  24.411  &lt; 2e-16 ***\nGroups1       -0.025634   0.028744  -0.892  0.37783    \nGroups2        0.007566   0.028744   0.263  0.79373    \nGroups3        0.041680   0.028744   1.450  0.15484    \nTime1          0.054609   0.016595   3.291  0.00209 ** \nGroups1:Time1  0.021088   0.028744   0.734  0.46744    \nGroups2:Time1 -0.047540   0.028744  -1.654  0.10598    \nGroups3:Time1  0.008394   0.028744   0.292  0.77179    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.115 on 40 degrees of freedom\nMultiple R-squared:  0.2905,    Adjusted R-squared:  0.1663 \nF-statistic: 2.339 on 7 and 40 DF,  p-value: 0.04231\n\nanova(RegLin)\n\nAnalysis of Variance Table\n\nResponse: NEFA\n            Df  Sum Sq  Mean Sq F value   Pr(&gt;F)   \nGroups       3 0.03611 0.012037  0.9105 0.444523   \nTime         1 0.14314 0.143141 10.8280 0.002093 **\nGroups:Time  3 0.03722 0.012405  0.9384 0.431127   \nResiduals   40 0.52878 0.013220                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nRegLinME&lt;-lmer(NEFA~Groups*Time+(1|Rats),data=df)\nsummary(RegLinME)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: NEFA ~ Groups * Time + (1 | Rats)\n   Data: df\n\nREML criterion at convergence: -34.1\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-1.92736 -0.46372 -0.03845  0.47918  1.87916 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Rats     (Intercept) 0.000182 0.01349 \n Residual             0.013038 0.11418 \nNumber of obs: 48, groups:  Rats, 24\n\nFixed effects:\n               Estimate Std. Error        df t value Pr(&gt;|t|)    \n(Intercept)    0.405113   0.016709 19.999949  24.245 2.66e-16 ***\nGroups1       -0.025634   0.028941 19.999949  -0.886  0.38629    \nGroups2        0.007566   0.028941 19.999949   0.261  0.79644    \nGroups3        0.041680   0.028941 19.999949   1.440  0.16529    \nTime1          0.054609   0.016481 19.999942   3.313  0.00347 ** \nGroups1:Time1  0.021088   0.028545 19.999942   0.739  0.46864    \nGroups2:Time1 -0.047540   0.028545 19.999942  -1.665  0.11142    \nGroups3:Time1  0.008394   0.028545 19.999942   0.294  0.77175    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) Grops1 Grops2 Grops3 Time1  Gr1:T1 Gr2:T1\nGroups1      0.000                                          \nGroups2      0.000 -0.333                                   \nGroups3      0.000 -0.333 -0.333                            \nTime1        0.000  0.000  0.000  0.000                     \nGroups1:Tm1  0.000  0.000  0.000  0.000  0.000              \nGroups2:Tm1  0.000  0.000  0.000  0.000  0.000 -0.333       \nGroups3:Tm1  0.000  0.000  0.000  0.000  0.000 -0.333 -0.333\n\nanova(RegLinME)\n\nType III Analysis of Variance Table with Satterthwaite's method\n              Sum Sq  Mean Sq NumDF DenDF F value   Pr(&gt;F)   \nGroups      0.035129 0.011710     3    20  0.8981 0.459421   \nTime        0.143141 0.143141     1    20 10.9792 0.003467 **\nGroups:Time 0.037216 0.012405     3    20  0.9515 0.434661   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nLa différence entre les deux modèles est très faible ce qui s’explique par le fait qu’il n’y a que deux mesures différentes par rat.\nOn peut ajouter des covariables dans le modèle (les autres paramètres biochimiques)\n\nLinModE&lt;-lmer(NEFA~Time*Groups+\n                BW+Cholesterol+Insulinemia+TG+(1|Rats),data=df)\nanova(LinModE)\n\nType III Analysis of Variance Table with Satterthwaite's method\n              Sum Sq  Mean Sq NumDF  DenDF F value  Pr(&gt;F)  \nTime        0.003758 0.003758     1 30.909  0.3027 0.58616  \nGroups      0.012932 0.004311     3 21.948  0.3472 0.79152  \nBW          0.002444 0.002444     1 21.046  0.1968 0.66184  \nCholesterol 0.063661 0.063661     1 30.773  5.1269 0.03075 *\nInsulinemia 0.000024 0.000024     1 34.629  0.0019 0.96530  \nTG          0.002964 0.002964     1 34.009  0.2387 0.62826  \nTime:Groups 0.030426 0.010142     3 20.713  0.8168 0.49920  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nSi on veut un modèle plus parcimonieux (on ne garde que les variables significatives), alors on utilise la fonction step :\n\nstep(LinModE)\n\nBackward reduced random-effect table:\n\n           Eliminated npar logLik    AIC       LRT Df Pr(&gt;Chisq)\n&lt;none&gt;                  14 6.8252 14.350                        \n(1 | Rats)          1   13 6.8219 12.356 0.0065287  1     0.9356\n\nBackward reduced fixed-effect table:\n            Eliminated Df Sum of Sq     RSS     AIC F value  Pr(&gt;F)  \nInsulinemia          1  1  0.000017 0.45533 -201.58  0.0013 0.97110  \nBW                   2  1  0.002678 0.45801 -203.30  0.2176 0.64361  \nTG                   3  1  0.002849 0.46086 -205.00  0.2364 0.62963  \nTime:Groups          4  3  0.039239 0.50010 -207.08  1.1069 0.35795  \nGroups               5  3  0.023605 0.52370 -210.87  0.6608 0.58079  \nTime                 0  1  0.048804 0.57251 -208.59  4.1935 0.04644 *\nCholesterol          0  1  0.078402 0.60211 -206.17  6.7368 0.01271 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nModel found:\nNEFA ~ Time + Cholesterol"
  },
  {
    "objectID": "LME.html#vérification-de-la-qualité-mathématique-du-modèle.",
    "href": "LME.html#vérification-de-la-qualité-mathématique-du-modèle.",
    "title": "Introduction",
    "section": "Vérification de la qualité (mathématique) du modèle.",
    "text": "Vérification de la qualité (mathématique) du modèle.\n\nNormalité et indépendance des résidus du modèle\nOn a supposé que les résidus \\(\\varepsilon_{ijk}\\) sont distribués normalement on peut le vérifier graphiquement\n\nqqnorm(residuals(LinModE),pch=20)\nqqline(residuals(LinModE),pch=20)\n\n\n\n\nou bien grâce au test de Shapiro-Wilk\n\nshapiro.test(residuals(modLin))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(modLin)\nW = 0.97806, p-value = 0.8576\n\n\nOn peut donc considérer que les résidus sont normaux.\nPour vérifier l’indépendance on regarde si il existe un lien entre les valeurs prédites et les résidus :\n\nplot(residuals(LinModE),fitted(LinModE),pch=20)\n\n\n\n\nClairement il n’y pas de lien !\n\n\nNormalité des effets aléatoires\n\nqqnorm(ranef(LinModE)$Rats$`(Intercept)`)\nqqline(ranef(LinModE)$Rats$`(Intercept)`)\n\n\n\nshapiro.test(ranef(LinModE)$Rats$`(Intercept)`)\n\n\n    Shapiro-Wilk normality test\n\ndata:  ranef(LinModE)$Rats$`(Intercept)`\nW = 0.98058, p-value = 0.9064"
  },
  {
    "objectID": "Dispo_expe.html",
    "href": "Dispo_expe.html",
    "title": "Règle des 3R en expérimentation animale",
    "section": "",
    "text": "Elaborée en 1959, née de la réflexion éthique de Russel W. et Burch R., appliquée à l’expérimentation animale en Europe et Amérique du Nord.\n3 R : Réduire, Remplacer, Raffiner.\n\n\n\nObjectif : diminuer le nombre d’animaux utilisés en recherche :\n\naux expériences absolument indispensables\nNe pas répéter des expériences antérieures\n\nMoyen : Rédiger un protocole expérimental avant l’expérience.\n\n\n\n\nTravailler sur des cellules ou des tissus (IN VITRO)\nSimuler numériquement (IN SILICO) les maladies et leur développement \\(\\leadsto\\) approche encore imparfaite vue la compléxité du fonctionnement biologique.\n\n\n\n\nOptimiser l’expérimentation pour réduire, supprimer ou soulager la douleur ou la détresse, et ainsi d’améliorer le bien-être des animaux utilisés.\nD’un point de vue statistique, le recours aux plans d’expérience va permettre de contribuer aux 3R."
  },
  {
    "objectID": "Dispo_expe.html#réduire",
    "href": "Dispo_expe.html#réduire",
    "title": "Règle des 3R en expérimentation animale",
    "section": "",
    "text": "Objectif : diminuer le nombre d’animaux utilisés en recherche :\n\naux expériences absolument indispensables\nNe pas répéter des expériences antérieures\n\nMoyen : Rédiger un protocole expérimental avant l’expérience."
  },
  {
    "objectID": "Dispo_expe.html#remplacer",
    "href": "Dispo_expe.html#remplacer",
    "title": "Règle des 3R en expérimentation animale",
    "section": "",
    "text": "Travailler sur des cellules ou des tissus (IN VITRO)\nSimuler numériquement (IN SILICO) les maladies et leur développement \\(\\leadsto\\) approche encore imparfaite vue la compléxité du fonctionnement biologique."
  },
  {
    "objectID": "Dispo_expe.html#raffiner",
    "href": "Dispo_expe.html#raffiner",
    "title": "Règle des 3R en expérimentation animale",
    "section": "",
    "text": "Optimiser l’expérimentation pour réduire, supprimer ou soulager la douleur ou la détresse, et ainsi d’améliorer le bien-être des animaux utilisés.\nD’un point de vue statistique, le recours aux plans d’expérience va permettre de contribuer aux 3R."
  },
  {
    "objectID": "Dispo_expe.html#généralités",
    "href": "Dispo_expe.html#généralités",
    "title": "Règle des 3R en expérimentation animale",
    "section": "Généralités",
    "text": "Généralités\nDans un plan d’expérience à mesures répétées, un même sujet est mesuré sous chacun des niveaux d’un traitement.\nObjectifs :\n\nMeilleur contrôle des différences individuelles entre les sujets.\nRéduire l’erreur expérimentale, la variabilité due aux différences individuelles.\n\nDans ce type de dispositif on considère souvent un facteur BETWEEN (inter-individuel) qui permet d’étudier si l’effet du traitement (ou de l’exposition) est différent selon le niveau de ce facteur BETWEEN."
  },
  {
    "objectID": "Dispo_expe.html#etude-longitudinale",
    "href": "Dispo_expe.html#etude-longitudinale",
    "title": "Statistique pour l'expérimentation animale",
    "section": "Etude longitudinale",
    "text": "Etude longitudinale\n\nSuivi d’une population (ou d’un phénomène) dans le temps.\nAu moins deux périodes distinctes avec des sujets identiques.\n\n\nExemple\nUne étude de l’école avait pour objectif de contrôler l’effet au cours du temps de 4 régimes alimentaires sur les paramètres biochimiques liés au contrôle de l’obésité.\nOn constitue 4 groupes de 6 rats :\n\nun groupe contrôle (CC),\nun groupe recevant un régime enrichi en lipide (LL),\nun régime enrichi en fructose (FF)\nun enrichi en lipide et fructose (LF).\n\nLes variables réponses sont les suivantes :\n\nBody Weigth ( poids corporel),\nMasse grasse corporelle,\nGlycémie,\nInsulinémie,\nTaux de cholestérol,\nTaux de triglycérides,\nNon Esterified Fatty Acid.\n\nToutes les données sont mesurées au bout d’une semaine (Week1) puis de 11 (Week11).\nLe plan d’expérience peut être résumé par la figure suivante :\n\n\n\nfigure 1\n\n\nUn extrait des données recueillies :\nOn étudie\n\nrats <- read_excel(\"data1.xlsx\")\nrats$Groups<-factor(rats$Groups,levels=c(\"CC\",\"LL\",\"FF\",\"LF\"),labels=c(\"CC\",\"LL\",\"FF\",\"LF\"))\nrats$Time<-factor(rats$Time,levels=c(\"Week 1\",\"Week 11\"))\nkable(head(rats),digits=2)\n\n\n\n \n  \n    Rats \n    Groups \n    Time \n    BW \n    body fat \n    Glycemia \n    Insulinemia \n    Cholesterol \n    TG \n    NEFA \n  \n \n\n  \n    1 \n    CC \n    Week 1 \n    385.4 \n    44.58 \n    5.13 \n    2.41 \n    1.31 \n    1.83 \n    0.54 \n  \n  \n    2 \n    CC \n    Week 1 \n    392.4 \n    23.70 \n    5.45 \n    2.23 \n    2.02 \n    1.34 \n    0.51 \n  \n  \n    3 \n    CC \n    Week 1 \n    406.1 \n    36.19 \n    5.52 \n    2.36 \n    1.82 \n    1.82 \n    0.28 \n  \n  \n    4 \n    CC \n    Week 1 \n    421.6 \n    36.30 \n    5.46 \n    2.17 \n    1.69 \n    2.41 \n    0.65 \n  \n  \n    5 \n    CC \n    Week 1 \n    385.9 \n    43.24 \n    5.52 \n    2.34 \n    2.03 \n    2.15 \n    0.23 \n  \n  \n    6 \n    CC \n    Week 1 \n    412.9 \n    29.37 \n    5.95 \n    2.50 \n    1.95 \n    1.77 \n    0.51"
  },
  {
    "objectID": "Dispo_expe.html#etude-de-type-crossover",
    "href": "Dispo_expe.html#etude-de-type-crossover",
    "title": "Statistique pour l'expérimentation animale",
    "section": "Etude de type crossover",
    "text": "Etude de type crossover\nUne étude croisée ou un essai croisé est une étude longitudinale dans laquelle les sujets reçoivent une séquence de traitements (ou d’expositions) différents.\n\nExemple :\nLes effets comportementaux d’un programme de socialisation des chiots ont été évalués chez 58 chiots de race pure et 10 chiots croisés. Chaque sujet a été réparti au hasard dans l’un des cinq groupes : Socialisation plus formation (S & T, n=12), Socialisation (n=10), Formation (n=13), Alimentation (n=12) et Contrôle (n=11). Pour chaque chiot on mesure la réponse à un ensemble de stimuli (commandes, manipulations,…). On s’intéresse à l’intéraction entre le type de stimuli (mesures répétées, effet WITHIN) et le type de programme (effet BETWEEN).\nBibliographie : Kersti Seksel, Evalynn J Mazurski, Alan Taylor, Puppy socialisation programs: short and long term behavioural effects, Applied Animal Behaviour Science, Volume 62, Issue 4, 1999, Pages 335-349, ISSN 0168-1591,doi."
  },
  {
    "objectID": "Dispo_expe.html#etudes-de-type-split-plot",
    "href": "Dispo_expe.html#etudes-de-type-split-plot",
    "title": "Statistique pour l'expérimentation animale",
    "section": "Etudes de type SPLIT-PLOT",
    "text": "Etudes de type SPLIT-PLOT\nSplit-plot : parcelle fractionnée Pour éviter des répétitions, souvent onéreuses, on peut utiliser la technique dite de SPLIT-PLOT.\nPar exemple on veut tester l’effet de 3 préparations de pâtes et quatre températures de four sur la qualité visuelle d’une pâte à tarte. On veut répliquer 3 fois l’expérience.\nQuestion : si on veut faire une expérimentation totalement randomisée combien de préparations sont nécessaires ?\nDispositif Split-Plot On réplique 3 fois chaque recette (plot) et on partage en 4 chaque préparation (split) et on les assigne aléatoirement à chaque température.\n\nMise en oeuvre\nOn considère deux facteurs \\(A,B\\) ayant respectivement \\(I,J\\) niveaux. On choisit le facteur \\(A\\) sur lequel portera la contrainte.\n\nRépéter \\(K\\) fois chaque niveau \\(a_i\\) de \\(A\\). On note \\(R_{k,i}\\) ces blocs\nPartager chaque blocc \\(R_{k,i}\\) (plot) en \\(J\\) sous-blocs (split) qui seront assignés aléatoirement à chaque niveau de \\(B.\\)\n\nOn a donc \\(N=I\\times J \\times K\\) essais."
  },
  {
    "objectID": "Dispo_expe.html#modélisation-1-anova-sur-mesures-indépendantes-aggrégation-des-données-sur-time",
    "href": "Dispo_expe.html#modélisation-1-anova-sur-mesures-indépendantes-aggrégation-des-données-sur-time",
    "title": "Règle des 3R en expérimentation animale",
    "section": "Modélisation 1 : ANOVA sur mesures indépendantes (aggrégation des données sur Time)",
    "text": "Modélisation 1 : ANOVA sur mesures indépendantes (aggrégation des données sur Time)\nOn calcule les moyennes entre la semaine 1 et la semaine 11 de toutes les variables considérées sur les rats.\nDu côté de R : on utilise la librarie dplyr très pratique pour manipuler les données. Le site https://juba.github.io/tidyverse/10-dplyr.html constitue une très bonne introduction à ce package.\n\nLe modèle mathématique et les hypothèses des tests\nOn considère un facteur \\(A\\) à \\(J\\) niveaux, le modèle est\n\\[\nY_{ij}=\\mu+\\alpha_{j}+\\varepsilon_{ij},\n\\]\noù \\(Y_{ij}\\) est la réponse pour l’individu \\(i\\) affecté dans le groupe \\(j=1,...,J\\). Les paramètres \\(\\alpha_j\\) sont appelés effets principaux du facteur \\(A\\) on suppose que \\(\\sum_{j=1}^J\\alpha_j=0.\\)\nOn suppose que \\(\\varepsilon_{ij}\\sim \\mathcal N(0,\\sigma^2)\\) (hypothèse d’homoscédasticité).\nIl a deux questions principalement associées à ce modèle :\n\nl’estimation des coefficients \\(\\mu,\\alpha_1,...,\\alpha_{J-1}\\)\nla significativité de ces coefficients\n\nPour l’estimation on utilise la méthode MCO (moindres carrés ordinaires) et on obtient\n\\(\\hat \\mu=\\frac 1{J}\\sum_{j=1}^J\\bar Y_j\\) et \\(\\hat \\alpha_j=\\bar Y_j-\\hat \\mu.\\)\nRemarque : si tous les groupes sont équilibrés on a \\(\\hat \\mu=\\overline{\\overline Y}.\\)\nOn teste deux hypothèses :\n\nLe facteur \\(A\\) a un effet sur la réponse \\(Y.\\) D’un point de vue mathématique on va tester \\(H_0:\\alpha_1=...=\\alpha_J=0\\). Le test utilisé s’appelle le test de Fisher (test Omnibus)\nOn peut être intéressé uniquement par tester l’effet d’un des niveaux de \\(A\\) c’est à dire \\(H_0:\\alpha_j=0\\) pour l’un des niveaux \\(j\\) de \\(A\\). Ce test est un test de Student.\n\nOn va étudier par exemple les variables BW et Insulinemia.\n\ncolnames(rats)\n\n [1] \"Rats\"        \"Groups\"      \"Time\"        \"BW\"          \"body fat\"   \n [6] \"Glycemia\"    \"Insulinemia\" \"Cholesterol\" \"TG\"          \"NEFA\"       \n\ndf1 = rats %&gt;% \n  group_by(Rats,Groups) %&gt;%\n  summarise(NEFA=mean(NEFA),TG=mean(TG),C=mean(Cholesterol),\n            BW=mean(BW),I=mean(Insulinemia)) \nkable(head(df1))\n\n\n\n\nRats\nGroups\nNEFA\nTG\nC\nBW\nI\n\n\n\n\n1\nCC\n0.3579423\n1.676122\n1.521581\n435.20\n2.357126\n\n\n2\nCC\n0.4165651\n1.492578\n2.196187\n440.60\n2.518081\n\n\n3\nCC\n0.3132758\n1.837344\n2.117650\n483.05\n2.292124\n\n\n4\nCC\n0.4525670\n2.172607\n1.689075\n495.00\n2.175999\n\n\n5\nCC\n0.2543409\n1.912967\n2.138862\n453.15\n2.243141\n\n\n6\nCC\n0.4821821\n1.498147\n1.858858\n473.80\n2.379702\n\n\n\n\n\n\n\n\n\nEtude de l’effet régime sur BW\nOn commence par faire une représentation graphique de NEFA en fonction du groupe\n\nggplot(df1,aes(x=Groups,y=BW))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"BW en fonction du régime\")\n\n\n\n\nQuestion Le regime semble t’il avoir un effet sur BW ? Quel groupe a la plus grande dispersion ? A combien d’observations correspondent les boxplots ?\n\nrelevel(df1$Groups,ref=\"CC\")\n\n [1] CC CC CC CC CC CC LL LL LL LL LL LL FF FF FF FF FF FF LF LF LF LF LF LF\nLevels: CC LL FF LF\n\nmodLin&lt;-lm(BW~Groups,data=df1)\nlibrary(car)\nAnova(modLin,type = \"III\") %&gt;% kable(digits=3)\n\n\n\n\n\nSum Sq\nDf\nF value\nPr(&gt;F)\n\n\n\n\n(Intercept)\n5083737.402\n1\n3258.547\n0.000\n\n\nGroups\n309.531\n3\n0.066\n0.977\n\n\nResiduals\n31202.482\n20\n\n\n\n\n\n\n\n\nsummary(modLin)\n\n\nCall:\nlm(formula = BW ~ Groups, data = df1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-66.658 -28.969   0.433  24.258  73.892 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  460.242      8.063  57.084   &lt;2e-16 ***\nGroups1        3.225     13.965   0.231    0.820    \nGroups2       -2.083     13.965  -0.149    0.883    \nGroups3        3.683     13.965   0.264    0.795    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 39.5 on 20 degrees of freedom\nMultiple R-squared:  0.009823,  Adjusted R-squared:  -0.1387 \nF-statistic: 0.06613 on 3 and 20 DF,  p-value: 0.9772\n\n\n\n\nEtude de l’effet régime sur la variable Insulinemia\n\nggplot(df1,aes(x=Groups,y=I))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"Insulinemia en fonction du régime\")\n\n\n\n\nLes résultats du modèle d’ANOVA :\n\nmodLin&lt;-lm(I~Groups,data=df1)\nlibrary(car)\nAnova(modLin,type = \"III\") %&gt;% kable(digits=3)\n\n\n\n\n\nSum Sq\nDf\nF value\nPr(&gt;F)\n\n\n\n\n(Intercept)\n163.156\n1\n1276.855\n0\n\n\nGroups\n6.061\n3\n15.811\n0\n\n\nResiduals\n2.556\n20\n\n\n\n\n\n\n\n\nsummary(modLin)\n\n\nCall:\nlm(formula = I ~ Groups, data = df1)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.67229 -0.14827 -0.05179  0.06656  1.07946 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  2.60733    0.07297  35.733   &lt;2e-16 ***\nGroups1     -0.27964    0.12638  -2.213   0.0387 *  \nGroups2     -0.27377    0.12638  -2.166   0.0426 *  \nGroups3     -0.31656    0.12638  -2.505   0.0210 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3575 on 20 degrees of freedom\nMultiple R-squared:  0.7034,    Adjusted R-squared:  0.6589 \nF-statistic: 15.81 on 3 and 20 DF,  p-value: 1.665e-05\n\n\nOn peut également réaliser des comparaisons par paires (on dit aussi tests post-hoc ou Test de Tukey) pour compléter l’analyse précédente :\n\nlibrary(multcomp)\npost_hoc&lt;-glht(modLin,linfct = mcp(\"Groups\"=\"Tukey\"))\nsummary(post_hoc)\n\n\n     Simultaneous Tests for General Linear Hypotheses\n\nMultiple Comparisons of Means: Tukey Contrasts\n\n\nFit: lm(formula = I ~ Groups, data = df1)\n\nLinear Hypotheses:\n              Estimate Std. Error t value Pr(&gt;|t|)    \nLL - CC == 0  0.005868   0.206381   0.028    1.000    \nFF - CC == 0 -0.036923   0.206381  -0.179    0.998    \nLF - CC == 0  1.149596   0.206381   5.570   &lt;1e-04 ***\nFF - LL == 0 -0.042791   0.206381  -0.207    0.997    \nLF - LL == 0  1.143728   0.206381   5.542   &lt;1e-04 ***\nLF - FF == 0  1.186519   0.206381   5.749   &lt;1e-04 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n(Adjusted p values reported -- single-step method)\n\n\nAttention dans le cas de la variable TG on n’a pas fait de test post-hoc : c’était inutile étant donné que le test global de Fisher était non significatif."
  },
  {
    "objectID": "Dispo_expe.html#ecriture-du-modèle",
    "href": "Dispo_expe.html#ecriture-du-modèle",
    "title": "Statistique pour l'expérimentation animale",
    "section": "Ecriture du modèle",
    "text": "Ecriture du modèle\nOn considère un facteur \\(A\\) à \\(J\\) niveaux, on suppose avoir plusieurs mesures pour chaque individus (mesures répétées). Le facteur répétition est noté \\(\\rho\\)\n\\[\nY_{ijk}=\\mu+\\rho_k+\\alpha_j+\\varepsilon_{ijk},\n\\]\noù \\(Y_{ik}\\) est la réponse pour l’individu \\(i\\) au niveau \\(j=1,...,J\\) du facteur \\(A\\).\nOn suppose que :\n\n\\(\\rho_k\\sim \\mathcal N(0,\\sigma^2_\\rho).\\) Cette hypothèse revient à considérer que les individus observés sont tirés aléatoirement dans une population normale d’écart type \\(\\sigma_\\rho.\\)\nLes variables \\(\\rho_k\\) et \\(\\varepsilon_{ijk}\\) sont indépendantes.\n\\(\\varepsilon_{ijk}\\sim \\mathcal N(0,\\sigma^2)\\) (hypothèse d’homoscédasticité).\n\n\nRetour sur l’exemple des rats :\n\n\nétude de l’effet temporel :\n\\(BW_{ij}=\\mu+\\rho_k+\\alpha_j+\\varepsilon_{ijk}\\)\n\nggplot(rats,aes(x=Time,y=BW))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"BW en fonction du temps\")\n\n\n\n\nRegardons les analyses descriptives de BW en fonction de Time :\n\nx<-rats %>% group_by(Rats) %>% summarise(BW=mean(BW))\nmean(x$BW)\n\n[1] 460.2417\n\nsd(x$BW)\n\n[1] 37.01469\n\n\nDans R pour définir un modèle à effets mixtes on va utiliser le package lmerTest. Pour indiquer l’effet aléatoire sujet\n\nlibrary(lmerTest)\nrats$Rats<-as.factor(rats$Rats)\nmod<-lmer(BW~Time+(1|Rats),REML=F,data=rats)\nsummary(mod)\n\nLinear mixed model fit by maximum likelihood . t-tests use Satterthwaite's\n  method [lmerModLmerTest]\nFormula: BW ~ Time + (1 | Rats)\n   Data: rats\n\n     AIC      BIC   logLik deviance df.resid \n   466.5    474.0   -229.2    458.5       44 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.0217 -0.3774  0.0028  0.3378  2.5414 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Rats     (Intercept) 1183.8   34.41   \n Residual              258.3   16.07   \nNumber of obs: 48, groups:  Rats, 24\n\nFixed effects:\n            Estimate Std. Error      df t value Pr(>|t|)    \n(Intercept)  460.242      7.397  24.000   62.22   <2e-16 ***\nTime1        -68.129      2.320  24.000  -29.37   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n      (Intr)\nTime1 0.000 \n\n\nL’effet du temps est testé via l’hypothèse \\(H_0:\\tau_t=0.\\)\n\nanova(mod)\n\nType III Analysis of Variance Table with Satterthwaite's method\n     Sum Sq Mean Sq NumDF DenDF F value    Pr(>F)    \nTime 222796  222796     1    24  862.45 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nOn peut tester si l’effet sujet est significatif (ce n’est pas obligatoire) c’est à dire tester \\(H_0: \\sigma^2_\\mu=0\\)\n\nranova(mod)\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nBW ~ Time + (1 | Rats)\n           npar  logLik    AIC    LRT Df Pr(>Chisq)    \n<none>        4 -229.24 466.48                         \n(1 | Rats)    3 -242.68 491.37 26.888  1  2.156e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "Dispo_expe.html#anova-à-deux-facteurs-fixes-et-un-facteur-aléatoire",
    "href": "Dispo_expe.html#anova-à-deux-facteurs-fixes-et-un-facteur-aléatoire",
    "title": "Règle des 3R en expérimentation animale",
    "section": "ANOVA à deux facteurs fixes et un facteur aléatoire",
    "text": "ANOVA à deux facteurs fixes et un facteur aléatoire\nOn peut ajouter l’effet régime à l’effet temporel :\n\\[\nBW_{ijk}=\\mu+\\rho_k+\\alpha_i+\\beta_j+(\\alpha\\beta)_{ij}+\\varepsilon_{ijk}\n\\] Dans le modèle on a considéré une éventuelle intercation entre les deux facteurs.\nReprésentation graphique :\n\nggplot(rats,aes(x=Time,y=BW,fill=Groups))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"BW en fonction du temps et du régime\")\n\n\n\n\nEstimation du modèle sur R :\n\nmod&lt;-lmer(BW~Groups*Time+(1|Rats),data=rats)\nsummary(mod)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: BW ~ Groups * Time + (1 | Rats)\n   Data: rats\n\nREML criterion at convergence: 410.7\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.6167 -0.4554 -0.0118  0.4622  2.0726 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Rats     (Intercept) 1433     37.85   \n Residual              255     15.97   \nNumber of obs: 48, groups:  Rats, 24\n\nFixed effects:\n              Estimate Std. Error      df t value Pr(&gt;|t|)    \n(Intercept)    460.242      8.063  20.000  57.084   &lt;2e-16 ***\nGroups1          3.225     13.965  20.000   0.231   0.8197    \nGroups2         -2.083     13.965  20.000  -0.149   0.8829    \nGroups3          3.683     13.965  20.000   0.264   0.7947    \nTime1          -68.129      2.305  20.000 -29.558   &lt;2e-16 ***\nGroups1:Time1    5.379      3.992  20.000   1.347   0.1929    \nGroups2:Time1   -7.212      3.992  20.000  -1.807   0.0859 .  \nGroups3:Time1    3.037      3.992  20.000   0.761   0.4556    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) Grops1 Grops2 Grops3 Time1  Gr1:T1 Gr2:T1\nGroups1      0.000                                          \nGroups2      0.000 -0.333                                   \nGroups3      0.000 -0.333 -0.333                            \nTime1        0.000  0.000  0.000  0.000                     \nGroups1:Tm1  0.000  0.000  0.000  0.000  0.000              \nGroups2:Tm1  0.000  0.000  0.000  0.000  0.000 -0.333       \nGroups3:Tm1  0.000  0.000  0.000  0.000  0.000 -0.333 -0.333\n\n\nRemarques :\n\nComme précédemment l’estimation de \\(\\mu\\) correspond à la moyenne des poids corporels.\nDans ce modèle il y a beaucoup de coefficients correspondants aux effets principaux (Groupe et Time) et aux effets d’interaction.\n\nPour tester la significativité des effets on va utiliser la fonction anova.\n\nanova(mod)\n\nType III Analysis of Variance Table with Satterthwaite's method\n            Sum Sq Mean Sq NumDF DenDF  F value Pr(&gt;F)    \nGroups          51      17     3    20   0.0661 0.9772    \nTime        222796  222796     1    20 873.6541 &lt;2e-16 ***\nGroups:Time   1100     367     3    20   1.4373 0.2616    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nOn commence toujours par regarder l’effet d’intercation. Il est ici non significatif ce qui signifie que l’effet du régime sur BW n’est pas différent entre la semaine 1 et la semaine 11 (\\(F(3,20)=1.43, \\ p=.2616\\)).\nL’effet du régime n’est pas significatif (\\(F(3,20)=0.0661, \\ p=.9772\\)).\nL’effet de la semaine est significatif (\\(F(1,20)=873.65, \\ p&lt;.001\\)).\n\nOn peut alors envisager un modèle plus parcimonieux (retirer l’effet d’interaction), on parle de modèle additif :\n\nmod&lt;-lmer(BW~Groups+Time+(1|Rats),data=rats)\nsummary(mod)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: BW ~ Groups + Time + (1 | Rats)\n   Data: rats\n\nREML criterion at convergence: 428.3\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-1.99916 -0.39801  0.02781  0.31629  2.46790 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Rats     (Intercept) 1425.3   37.75   \n Residual              269.6   16.42   \nNumber of obs: 48, groups:  Rats, 24\n\nFixed effects:\n            Estimate Std. Error      df t value Pr(&gt;|t|)    \n(Intercept)  460.242      8.063  20.000  57.084   &lt;2e-16 ***\nGroups1        3.225     13.965  20.000   0.231    0.820    \nGroups2       -2.083     13.965  20.000  -0.149    0.883    \nGroups3        3.683     13.965  20.000   0.264    0.795    \nTime1        -68.129      2.370  23.000 -28.749   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n        (Intr) Grops1 Grops2 Grops3\nGroups1  0.000                     \nGroups2  0.000 -0.333              \nGroups3  0.000 -0.333 -0.333       \nTime1    0.000  0.000  0.000  0.000"
  },
  {
    "objectID": "Dispo_expe.html#anova-pour-plans-slpit-plot",
    "href": "Dispo_expe.html#anova-pour-plans-slpit-plot",
    "title": "Statistique pour l'expérimentation animale",
    "section": "ANOVA pour plans slpit-plot",
    "text": "ANOVA pour plans slpit-plot\nDans ce type de dispositif le facteur réplication sera toujours considéré comme un facteur aléatoire (car il n’est pas randomisé!)\n\nFacteur \\(A\\) (coefficients \\(\\alpha\\)).\nFacteur \\(B\\) (coefficients \\(\\beta\\)).\nRéplication \\(R\\) (coefficients \\(\\rho\\)) .\n\n\\[\ny_{ijk}=\\mu+\\rho_k+\\alpha_i+\\beta_j+(\\alpha\\beta)_{ij}+(\\rho\\alpha)_{ki}+\\varepsilon_{ijk}\n\\]\noù \\(\\rho_k \\sim \\mathcal N(0,\\sigma^2_{\\rho})\\) et \\((\\rho\\alpha)_{ki} \\sim \\mathcal N(0,\\sigma^2_{\\alpha\\rho})\\)\n\nExemple :\nDonnées de la thèse d’exercice de Sarah Degand (2021) : EVALUATION DE L’IMPACT DU DILUEUR SUR LA CONCENTRATION EN PROAKAP4 DANS LE SPERME CONGELE DE BOUC : CORRELATION AVEC LA MOBILITE\n\ndf<-read_excel(\"ProAKAP4_BOUC.xlsx\")\n\nOn écrit le modèle\n\nmod<-lmer(mob5~Race*Milieu+(1|Bouc)+(Race|Bouc),data=df)\nanova(mod,type=3)\n\nType III Analysis of Variance Table with Satterthwaite's method\n             Sum Sq Mean Sq NumDF  DenDF F value Pr(>F)\nRace         20.419  20.419     1  6.999  0.1176 0.7417\nMilieu       93.518  46.759     2 68.000  0.2694 0.7647\nRace:Milieu 101.926  50.963     2 68.000  0.2936 0.7465"
  },
  {
    "objectID": "LME.html#notations",
    "href": "LME.html#notations",
    "title": "Introduction",
    "section": "Notations",
    "text": "Notations\n\nDans toute la suite la variable que l’on souhaite expliquer est notée \\(Y\\), le traitement sera noté \\(A\\) et les covariables au traitement seront notées \\(X\\) (dans l’écriture on se limitera à une seule covariable mais plusieurs peuvent être considérées).\nDans ce cours : \\(Y\\) est une variable continue, nous verrons dans un autre cours le cas où la variable est qualitative."
  },
  {
    "objectID": "Dispo_expe.html#exemple",
    "href": "Dispo_expe.html#exemple",
    "title": "Règle des 3R en expérimentation animale",
    "section": "Exemple",
    "text": "Exemple\nUne étude de l’école avait pour objectif de contrôler l’effet au cours du temps de 4 régimes alimentaires sur les paramètres biochimiques liés au contrôle de l’obésité.\nOn constitue 4 groupes de 6 rats :\n\nun groupe contrôle (CC),\nun groupe recevant un régime enrichi en lipide (LL),\nun régime enrichi en fructose (FF)\nun enrichi en lipide et fructose (LF).\n\nLes variables réponses sont les suivantes :\n\nBody Weigth ( poids corporel),\nMasse grasse corporelle,\nGlycémie,\nInsulinémie,\nTaux de cholestérol,\nTaux de triglycérides,\nNon Esterified Fatty Acid.\n\nToutes les données sont mesurées au bout d’une semaine (Week1) puis de 11 (Week11).\nLes données sont disponibles ici : data1\nLe plan d’expérience peut être résumé par la figure suivante :\n\n\n\nfigure 1\n\n\nUn extrait des données recueillies :\nOn étudie\n\nrats &lt;- read_excel(\"data1.xlsx\")\nrats$Groups&lt;-factor(rats$Groups,levels=c(\"CC\",\"LL\",\"FF\",\"LF\"),labels=c(\"CC\",\"LL\",\"FF\",\"LF\"))\nrats$Time&lt;-factor(rats$Time,levels=c(\"Week 1\",\"Week 11\"))\nkable(head(rats),digits=2)\n\n\n\n\nRats\nGroups\nTime\nBW\nbody fat\nGlycemia\nInsulinemia\nCholesterol\nTG\nNEFA\n\n\n\n\n1\nCC\nWeek 1\n385.4\n44.58\n5.13\n2.41\n1.31\n1.83\n0.54\n\n\n2\nCC\nWeek 1\n392.4\n23.70\n5.45\n2.23\n2.02\n1.34\n0.51\n\n\n3\nCC\nWeek 1\n406.1\n36.19\n5.52\n2.36\n1.82\n1.82\n0.28\n\n\n4\nCC\nWeek 1\n421.6\n36.30\n5.46\n2.17\n1.69\n2.41\n0.65\n\n\n5\nCC\nWeek 1\n385.9\n43.24\n5.52\n2.34\n2.03\n2.15\n0.23\n\n\n6\nCC\nWeek 1\n412.9\n29.37\n5.95\n2.50\n1.95\n1.77\n0.51"
  },
  {
    "objectID": "Dispo_expe.html#exemple-2",
    "href": "Dispo_expe.html#exemple-2",
    "title": "Règle des 3R en expérimentation animale",
    "section": "Exemple :",
    "text": "Exemple :\nDonnées de la thèse d’exercice de Sarah Degand (2021) : EVALUATION DE L’IMPACT DU DILUEUR SUR LA CONCENTRATION EN PROAKAP4 DANS LE SPERME CONGELE DE BOUC : CORRELATION AVEC LA MOBILITE\nétude la concentration de ProAKAP4 dans le sperme en fonction de la race et du bouc. Ici les boucs sont considérés par Race, donc l’effet bouc est imbriqué dans l’effet race.\n\ndf&lt;-read_excel(\"ProAKAP4_BOUC.xlsx\")\ndf$Bouc&lt;-as.factor(df$Bouc)\ndf$Race&lt;-as.factor(df$Race)\ndf$Milieu&lt;-as.factor(df$Milieu)\ntable(df$Bouc,df$Race)\n\n   \n    11 13\n  1  9  9\n  2  9  9\n  3  9  9\n  4  9  9\n  5  0  9\n\n\n\n\n\nexemple de facteurs imbriqués"
  },
  {
    "objectID": "Dispo_expe.html#mise-en-oeuvre",
    "href": "Dispo_expe.html#mise-en-oeuvre",
    "title": "Règle des 3R en expérimentation animale",
    "section": "Mise en oeuvre",
    "text": "Mise en oeuvre\nOn considère deux facteurs \\(A,B\\) ayant respectivement \\(I,J\\) niveaux. On choisit le facteur \\(A\\) sur lequel portera la contrainte.\n\nRépéter \\(K\\) fois chaque niveau \\(a_i\\) de \\(A\\). On note \\(R_{k,i}\\) ces blocs\nPartager chaque blocc \\(R_{k,i}\\) (plot) en \\(J\\) sous-blocs (split) qui seront assignés aléatoirement à chaque niveau de \\(B.\\)\n\nOn a donc \\(N=I\\times J \\times K\\) essais."
  },
  {
    "objectID": "Dispo_expe.html#exemple-3",
    "href": "Dispo_expe.html#exemple-3",
    "title": "Règle des 3R en expérimentation animale",
    "section": "Exemple :",
    "text": "Exemple :\nDonnées de la thèse d’exercice de Sarah Degand (2021) : On veut regarder l’effet du dilueur sur la concentration en ProAKAP4 Les données sont disponibles ici : ProAKAP4\n\ndf&lt;-read_excel(\"ProAKAP4_BOUC.xlsx\")\ndf$Bouc&lt;-as.factor(df$Bouc)\ndf$Race&lt;-as.factor(df$Race)\ndf$Milieu&lt;-as.factor(df$Milieu)\ntable(df$Bouc,df$Race)\n\n   \n    11 13\n  1  9  9\n  2  9  9\n  3  9  9\n  4  9  9\n  5  0  9\n\n\n\n\n\nexemple des boucs"
  },
  {
    "objectID": "Dispo_expe.html#etude-de-leffet-temporel-dans-létude-sur-les-rats",
    "href": "Dispo_expe.html#etude-de-leffet-temporel-dans-létude-sur-les-rats",
    "title": "Règle des 3R en expérimentation animale",
    "section": "Etude de l’effet temporel dans l’étude sur les rats",
    "text": "Etude de l’effet temporel dans l’étude sur les rats\nIci on va prendre la dimension temporelle des données. C’est à dire l’on modélise le fait que pour chaque rat il y a eu deux mesures de chaque propriété biochimique.\nRemarques\n\nAvec deux mesures par individu, la modélisation tenant compte de la mesure répétée est limitée à un effet aléatoire sur l’intercept du modèle.\nUn modèle dans lequel on considère des effets fixes et des effets aléatoires s’appelle un modèle à effet mixte.\n\n\nVariable réponse BW\nLe modèle\n\\[\nBW_{ik}=\\mu+\\rho_k+\\alpha_i+\\varepsilon_{ik}\n\\]\noù \\(BW_{ik}\\) représente le poids corporel du rat \\(k\\) à la semaine \\(i\\).\nIci on suppose que les rats sont prélevés aléatoirement dans une population de rats :\n\nL’effet rat est aléatoire c’est à dire que \\(\\rho_k\\sim \\mathcal N(0,\\sigma_\\rho)\\).\nL’effet semaine est fixe.\nLes variables aléatoires \\(\\rho_k\\) et \\(\\varepsilon_{ik}\\) sont indépendantes.\n\nReprésentation graphique :\n\nggplot(rats,aes(x=Time,y=BW))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"BW en fonction du temps\")\n\n\n\n\nRegardons les analyses descriptives de BW en fonction de Time :\n\ntab&lt;-rats %&gt;% group_by(Time) %&gt;% summarise(BW=mean(BW))\nkable(tab)\n\n\n\n\nTime\nBW\n\n\n\n\nWeek 1\n392.1125\n\n\nWeek 11\n528.3708\n\n\n\n\n\n\nmean(tab$BW)\n\n[1] 460.2417\n\n\nDans R pour définir un modèle à effets mixtes on va utiliser le package lmerTest. Pour indiquer l’effet aléatoire rats on utilise la synthaxe (1|Rats) :\n\nlibrary(lmerTest)\nrats$Rats&lt;-as.factor(rats$Rats)\nmod&lt;-lmer(BW~Time+(1|Rats),data=rats)\nsummary(mod)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: BW ~ Time + (1 | Rats)\n   Data: rats\n\nREML criterion at convergence: 449.1\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-1.97913 -0.36945  0.00274  0.33073  2.48793 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Rats     (Intercept) 1235.3   35.15   \n Residual              269.6   16.42   \nNumber of obs: 48, groups:  Rats, 24\n\nFixed effects:\n            Estimate Std. Error      df t value Pr(&gt;|t|)    \n(Intercept)  460.242      7.556  23.000   60.91   &lt;2e-16 ***\nTime1        -68.129      2.370  23.000  -28.75   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n      (Intr)\nTime1 0.000 \n\n\nRemarques : On constate que\n\nL’estimation de \\(\\mu\\) correspond au poids moyen des rats.\nL’estimation de \\(\\sigma_\\rho\\) est proche de l’écart type des rats.\n\nEn effet si on aggrège les données sur les rats (moyenne des deux semaines) on a :\n\nR&lt;-rats %&gt;% group_by(Rats) %&gt;% summarise(M=mean(BW))\nsd(R$M)\n\n[1] 37.01469\n\n\n\nL’estimation de l’effet temporel correspond à la différence entre la moyenne des rats et la moyenne de la semaine 1.\n\nLa fonction anova permet de tester si l’effet fixe (ici semaine) est significatif \\(H_0:\\alpha_1=...=\\alpha_I=0\\):\n\nanova(mod)\n\nType III Analysis of Variance Table with Satterthwaite's method\n     Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    \nTime 222796  222796     1    23  826.51 &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nLa fonction ranova permet de tester si l’effet aléatoire est significatif \\(H_0:\\sigma_\\rho=0\\):\n\nranova(mod)\n\nANOVA-like table for random-effects: Single term deletions\n\nModel:\nBW ~ Time + (1 | Rats)\n           npar  logLik    AIC    LRT Df Pr(&gt;Chisq)    \n&lt;none&gt;        4 -224.54 457.07                         \n(1 | Rats)    3 -237.42 480.84 25.768  1   3.85e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "Dispo_expe.html#effet-sur-insulinemia",
    "href": "Dispo_expe.html#effet-sur-insulinemia",
    "title": "Règle des 3R en expérimentation animale",
    "section": "Effet sur insulinemia",
    "text": "Effet sur insulinemia\n\nmod&lt;-lmer(Insulinemia~Groups+Time+(1|Rats),data=rats)\nanova(mod)\n\nType III Analysis of Variance Table with Satterthwaite's method\n       Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    \nGroups 8.8422 2.94741     3    20 15.8114 1.665e-05 ***\nTime   0.0034 0.00339     1    23  0.0182    0.8939    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nOn fait alors des tests post-hoc :\n\npost_hoc&lt;-glht(mod,linfct = mcp(\"Groups\"=\"Tukey\"))\nsummary(post_hoc)\n\n\n     Simultaneous Tests for General Linear Hypotheses\n\nMultiple Comparisons of Means: Tukey Contrasts\n\n\nFit: lmer(formula = Insulinemia ~ Groups + Time + (1 | Rats), data = rats)\n\nLinear Hypotheses:\n              Estimate Std. Error z value Pr(&gt;|z|)    \nLL - CC == 0  0.005868   0.206381   0.028    1.000    \nFF - CC == 0 -0.036923   0.206381  -0.179    0.998    \nLF - CC == 0  1.149596   0.206381   5.570   &lt;1e-06 ***\nFF - LL == 0 -0.042791   0.206381  -0.207    0.997    \nLF - LL == 0  1.143728   0.206381   5.542   &lt;1e-06 ***\nLF - FF == 0  1.186519   0.206381   5.749   &lt;1e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n(Adjusted p values reported -- single-step method)\n\n\n\nggplot(rats,aes(x=Time,y=Insulinemia,fill=Groups))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"Insulimenia en fonction du temps et du régime\")"
  },
  {
    "objectID": "docs/lme.html",
    "href": "docs/lme.html",
    "title": "Modèles linéaires à effets mixtes",
    "section": "",
    "text": "options(knitr.kable.NA = '')\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(dplyr)\nlibrary(readxl)\nlibrary(lmerTest)\nlibrary(kableExtra)\nlibrary(gtsummary)\noptions(contrasts=c(\"contr.sum\",\"contr.sum\"))"
  },
  {
    "objectID": "docs/lme.html#données-temporelles",
    "href": "docs/lme.html#données-temporelles",
    "title": "Modèles linéaires à effets mixtes",
    "section": "Données temporelles",
    "text": "Données temporelles\nLes mesures longitudinales et répétées sont des données temporelles. Elles sont très utilisées en expérimentation animale.\nUn cas classique est d’étudier l’effet d’un traitement, d’un régime sur des animaux au cours du temps."
  },
  {
    "objectID": "docs/lme.html#modélisation-statistique-de-données-indépendantes",
    "href": "docs/lme.html#modélisation-statistique-de-données-indépendantes",
    "title": "Modèles linéaires à effets mixtes",
    "section": "Modélisation statistique de données indépendantes",
    "text": "Modélisation statistique de données indépendantes\nDans toute la suite la variable que l’on souhaite expliquer est notée \\(Y\\), le traitement sera noté \\(A\\) et les covariables au traitement seront notées \\(X\\) (dans l’écriture on se limitera à une seule covariable mais plusieurs peuvent être considérées).\nDans ce cours : \\(Y\\) est une variable continue, nous verrons dans un autre cours le cas où la variable est qualitative.\nRevenons aux cas d’observations indépendantes : on veut étudier l’effet du traitement \\(A\\) sur \\(Y\\) en contrôlant la covariable \\(X\\). On a deux situations possibles :\n\n\\(A\\) est une variable continue (e.g. dose de médicament) et dans ce cas on écrit :\n\n\\[\nY_{i}=\\mu+\\alpha A_i+\\beta X_{i}+\\varepsilon_{i}\n\\]\n\\(Y_{ij}\\) valeur pour l’animal \\(i\\) et le niveau de traitement \\(j\\), \\(X_{ij}\\) étant la valeur de la covariable \\(X\\).\nEt alors on teste l’effet de \\(A\\) en testant \\(H_0:\\alpha=0.\\)\n\n\\(A\\) est une variable qualitative (e.g. un régime) qui possède différents niveaux (on note \\(a\\) le nombre de niveaux de \\(A\\)). Dans ce cas on écrit :\n\n\\[\nY_{ij}=\\mu+\\alpha_j +\\beta X_{ij}+\\varepsilon_{ij}\n\\] \\(Y_{ij}\\) valeur pour l’animal \\(i\\) et le niveau de traitement \\(j\\), \\(X_{ij}\\) étant la valeur de la covariable \\(X\\).\nPour tester l’effet du traitement \\(A\\) on va tester \\(H_0:\\alpha_1=...=\\alpha_a=0.\\)\nDans les deux cas \\(\\mu\\) représente l’intercept du modèle.\nDans cette modélisation les résidus sont supposés indépendants (c’est à dire au moins non corrélés). Ceci est plausible car il n’y a, a priori, aucun rapport entre les différents individus."
  },
  {
    "objectID": "docs/lme.html#exemple-issu-de-données-de-lécole",
    "href": "docs/lme.html#exemple-issu-de-données-de-lécole",
    "title": "Modèles linéaires à effets mixtes",
    "section": "Exemple issu de données de l’école",
    "text": "Exemple issu de données de l’école\nCette étude a pour objectif de contrôler l’effet au cours du temps de 4 régimes alimentaires sur les paramètres biochimiques liés au contrôle de l’obésité.\nOn constitue 4 groupes de 6 rats : un groupe contrôle (CC), un groupe recevant un régime enrichi en lipide (LL), un régime enrichi en fructose (FF) et un enrichi en lipide et fructose (LF).\nLes variables contrôlées sont les suivantes :\n\nBody Weigth ( poids corporel),\nMasse grasse corporelle,\nGlycémie,\nInsulinémie,\nTaux de cholestérol,\nTaux de triglycérides,\nNon Esterified Fatty Acid.\n\nToutes les données sont mesurées au bout d’une semaine (Week1) puis de 11 (Week11). Le plan d’expérience peut être résumé par la figure suivante :\n\n\n\nfigure 1\n\n\nUn extrait des données recueillies :\nOn étudie\n\ndf &lt;- read_excel(\"~/Dropbox/ONIRIS/cours/cours_VETO/EXPE_ANIMALE/data1.xlsx\")\ndf$Groups&lt;-factor(df$Groups,levels=c(\"CC\",\"LL\",\"FF\",\"LF\"),labels=c(\"CC\",\"LL\",\"FF\",\"LF\"))\ndf$Time&lt;-factor(df$Time,levels=c(\"Week 1\",\"Week 11\"))\nkable(head(df),digits=2)\n\n\n\n\nRats\nGroups\nTime\nBW\nbody fat\nGlycemia\nInsulinemia\nCholesterol\nTG\nNEFA\n\n\n\n\n1\nCC\nWeek 1\n385.4\n44.58\n5.13\n2.41\n1.31\n1.83\n0.54\n\n\n2\nCC\nWeek 1\n392.4\n23.70\n5.45\n2.23\n2.02\n1.34\n0.51\n\n\n3\nCC\nWeek 1\n406.1\n36.19\n5.52\n2.36\n1.82\n1.82\n0.28\n\n\n4\nCC\nWeek 1\n421.6\n36.30\n5.46\n2.17\n1.69\n2.41\n0.65\n\n\n5\nCC\nWeek 1\n385.9\n43.24\n5.52\n2.34\n2.03\n2.15\n0.23\n\n\n6\nCC\nWeek 1\n412.9\n29.37\n5.95\n2.50\n1.95\n1.77\n0.51\n\n\n\n\n\n\n\nQuestion : Les données sont elles dépendantes ou indépendantes ? Pourquoi ?"
  },
  {
    "objectID": "docs/lme.html#etude-de-leffet-régime",
    "href": "docs/lme.html#etude-de-leffet-régime",
    "title": "Modèles linéaires à effets mixtes",
    "section": "Etude de l’effet régime",
    "text": "Etude de l’effet régime\nOn commence par faire une représentation graphique de NEFA en fonction du groupe\n\nggplot(df1,aes(x=Groups,y=NEFA))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"NEFA en fonction du régime\")\n\n\n\n\nQuestion Le regime semble t’il avoir un effet sur NEFA ? Quel groupe a la plus grande dispersion ? A combien d’observations correspondent les boxplots\n\nrelevel(df1$Groups,ref=\"CC\")\n\n [1] CC CC CC CC CC CC LL LL LL LL LL LL FF FF FF FF FF FF LF LF LF LF LF LF\nLevels: CC LL FF LF\n\nmodLin&lt;-lm(NEFA~Groups,data=df1)\nanova(modLin) %&gt;% kable(digits=3)\n\n\n\n\n\nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\n\nGroups\n3\n0.018\n0.006\n0.898\n0.459\n\n\nResiduals\n20\n0.134\n0.007\n\n\n\n\n\n\n\n\nsummary(modLin)\n\n\nCall:\nlm(formula = NEFA ~ Groups, data = df1)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.12514 -0.04834 -0.00613  0.05089  0.16461 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.405113   0.016709  24.245 2.66e-16 ***\nGroups1     -0.025634   0.028941  -0.886    0.386    \nGroups2     -0.023612   0.028941  -0.816    0.424    \nGroups3      0.007566   0.028941   0.261    0.796    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.08186 on 20 degrees of freedom\nMultiple R-squared:  0.1187,    Adjusted R-squared:  -0.01346 \nF-statistic: 0.8981 on 3 and 20 DF,  p-value: 0.4594"
  },
  {
    "objectID": "docs/lme.html#modèle-à-intercept-aléatoire",
    "href": "docs/lme.html#modèle-à-intercept-aléatoire",
    "title": "Modèles linéaires à effets mixtes",
    "section": "Modèle à intercept aléatoire",
    "text": "Modèle à intercept aléatoire\n\nggplot(df,aes(x=Groups,y=NEFA,color=Time))+\n  geom_boxplot()+\n  theme_minimal()+\n  labs(title = \"NEFA en fonction du régime\")\n\n\n\n\nDans R pour définir un modèle à effets mixtes on va utiliser le package lmerTest.\nLa figure ci-dessus nous donne la différence de NEFA pour chaque rat du groupe CC (contrôle) en fonction de la semaine considérée.\nD’un point de vue modélisation on va écrire :\n\\[\nNEFA_{ij}=\\mu+\\alpha_i+\\beta_{j}+\\varepsilon_{ij},\n\\] où \\(i\\) est le numéro du rat (de 1 à 6) et \\(j\\) la semaine considérée (1 ou 11).\nOn obtient les résultats suivants (estimations avec la fonction lm de R).\n\ndfCC&lt;-as.data.frame(df%&gt;% filter(Groups==\"CC\"))\ndfCC$Rats&lt;-factor(dfCC$Rats)\ndfCC$Time&lt;-factor(dfCC$Time,levels=c(\"Week 11\",\"Week 1\"))\nrelevel(dfCC$Time,ref=\"Week 1\")\n\n [1] Week 1  Week 1  Week 1  Week 1  Week 1  Week 1  Week 11 Week 11 Week 11\n[10] Week 11 Week 11 Week 11\nLevels: Week 1 Week 11\n\nmod&lt;-lm(NEFA~Time+Rats,data=dfCC)\nsummary(mod)\n\n\nCall:\nlm(formula = NEFA ~ Time + Rats, data = dfCC)\n\nResiduals:\n       1        2        3        4        5        6        7        8 \n 0.11125  0.01505 -0.10442  0.12214 -0.09833 -0.04568 -0.11125 -0.01505 \n       9       10       11       12 \n 0.10442 -0.12214  0.09833  0.04568 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  0.37948    0.04090   9.279 0.000245 ***\nTime1       -0.07570    0.04090  -1.851 0.123413    \nRats1       -0.02154    0.09145  -0.235 0.823165    \nRats2        0.03709    0.09145   0.406 0.701859    \nRats3       -0.06620    0.09145  -0.724 0.501559    \nRats4        0.07309    0.09145   0.799 0.460437    \nRats5       -0.12514    0.09145  -1.368 0.229483    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1417 on 5 degrees of freedom\nMultiple R-squared:  0.5898,    Adjusted R-squared:  0.09756 \nF-statistic: 1.198 on 6 and 5 DF,  p-value: 0.4307\n\nplot(as.numeric(dfCC$Time),dfCC$NEFA,pch=20,col=dfCC$Rats,ylim=c(0,.6),\n     main=\"Groupe CC\",ylab=\"NEFA\")\nabline(a=coef(mod)[1],b=coef(mod)[2])\nfor(i in 1:5){\n  abline(a=coef(mod)[1]+coef(mod)[2+i],b=coef(mod)[2],col=(1+i))\n}\n\n\n\n\nEn soi, les résultats individuels des rats n’ont aucun intérêt, on veut seulement “neutraliser” les différences de NEFA qui sont associées à ces rats. Pour ce faire plutôt que de considérer un effet fixe par rat on va utiliser un effet aléatoire qui résumera l’effet “rat”.\nLe modèle précédent est toujours le même sauf que\n\\[\n\\alpha_i \\sim \\mathcal N(0,\\sigma^2_\\alpha)\n\\] avec \\(\\alpha_i,\\varepsilon_{ij}\\) indépendantes. On résume ainsi les différents coefficients \\(\\alpha_i\\) à une seule variance.\n\nmodE&lt;-lmer(NEFA~Time+(1|Rats),data=dfCC)\nsummary(modE)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: NEFA ~ Time + (1 | Rats)\n   Data: dfCC\n\nREML criterion at convergence: -7.1\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.6849 -0.5277  0.2272  0.4915  1.4720 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Rats     (Intercept) 0.00000  0.0000  \n Residual             0.01759  0.1326  \nNumber of obs: 12, groups:  Rats, 6\n\nFixed effects:\n            Estimate Std. Error       df t value Pr(&gt;|t|)    \n(Intercept)  0.37948    0.03829 10.00000   9.912 1.72e-06 ***\nTime1       -0.07570    0.03829 10.00000  -1.977   0.0762 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n      (Intr)\nTime1 0.000 \noptimizer (nloptwrap) convergence code: 0 (OK)\nboundary (singular) fit: see help('isSingular')\n\n\nOn constate que cela ne change pas l’estimation de l’effet semaine (appelé effet fixe)."
  },
  {
    "objectID": "docs/lme.html#retour-au-modèle-global",
    "href": "docs/lme.html#retour-au-modèle-global",
    "title": "Modèles linéaires à effets mixtes",
    "section": "Retour au modèle global",
    "text": "Retour au modèle global\n\\[\nNEFA_{ijk}=\\mu+\\alpha_i+\\beta_{j}+\\gamma_{k}+(\\beta\\gamma)_{jk}+\\varepsilon_{ijk},\n\\] où \\(i\\) est le numéro du rat, \\(j\\) le numéro de la semaine et \\(k\\) le numéro du groupe. On a donc trois effets fixes : semaine, groupe et leur interaction. Un effet aléatoire sur l’effet individuel rat.\n\nRegLin&lt;-lm(NEFA~Groups*Time,data=df)\nsummary(RegLin)\n\n\nCall:\nlm(formula = NEFA ~ Groups * Time, data = df)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.223468 -0.052560 -0.003011  0.056438  0.217414 \n\nCoefficients:\n               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    0.405113   0.016595  24.411  &lt; 2e-16 ***\nGroups1       -0.025634   0.028744  -0.892  0.37783    \nGroups2       -0.023612   0.028744  -0.821  0.41626    \nGroups3        0.007566   0.028744   0.263  0.79373    \nTime1          0.054609   0.016595   3.291  0.00209 ** \nGroups1:Time1  0.021088   0.028744   0.734  0.46744    \nGroups2:Time1  0.018058   0.028744   0.628  0.53342    \nGroups3:Time1 -0.047540   0.028744  -1.654  0.10598    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.115 on 40 degrees of freedom\nMultiple R-squared:  0.2905,    Adjusted R-squared:  0.1663 \nF-statistic: 2.339 on 7 and 40 DF,  p-value: 0.04231\n\nanova(RegLin)\n\nAnalysis of Variance Table\n\nResponse: NEFA\n            Df  Sum Sq  Mean Sq F value   Pr(&gt;F)   \nGroups       3 0.03611 0.012037  0.9105 0.444523   \nTime         1 0.14314 0.143141 10.8280 0.002093 **\nGroups:Time  3 0.03722 0.012405  0.9384 0.431127   \nResiduals   40 0.52878 0.013220                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nRegLinME&lt;-lmer(NEFA~Groups*Time+(1|Rats),data=df)\nsummary(RegLinME)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: NEFA ~ Groups * Time + (1 | Rats)\n   Data: df\n\nREML criterion at convergence: -34.1\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-1.92736 -0.46372 -0.03845  0.47918  1.87916 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Rats     (Intercept) 0.000182 0.01349 \n Residual             0.013038 0.11418 \nNumber of obs: 48, groups:  Rats, 24\n\nFixed effects:\n               Estimate Std. Error        df t value Pr(&gt;|t|)    \n(Intercept)    0.405113   0.016709 19.999949  24.245 2.66e-16 ***\nGroups1       -0.025634   0.028941 19.999949  -0.886  0.38629    \nGroups2       -0.023612   0.028941 19.999949  -0.816  0.42419    \nGroups3        0.007566   0.028941 19.999949   0.261  0.79644    \nTime1          0.054609   0.016481 19.999942   3.313  0.00347 ** \nGroups1:Time1  0.021088   0.028545 19.999942   0.739  0.46864    \nGroups2:Time1  0.018058   0.028545 19.999942   0.633  0.53416    \nGroups3:Time1 -0.047540   0.028545 19.999942  -1.665  0.11142    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) Grops1 Grops2 Grops3 Time1  Gr1:T1 Gr2:T1\nGroups1      0.000                                          \nGroups2      0.000 -0.333                                   \nGroups3      0.000 -0.333 -0.333                            \nTime1        0.000  0.000  0.000  0.000                     \nGroups1:Tm1  0.000  0.000  0.000  0.000  0.000              \nGroups2:Tm1  0.000  0.000  0.000  0.000  0.000 -0.333       \nGroups3:Tm1  0.000  0.000  0.000  0.000  0.000 -0.333 -0.333\n\nanova(RegLinME)\n\nType III Analysis of Variance Table with Satterthwaite's method\n              Sum Sq  Mean Sq NumDF DenDF F value   Pr(&gt;F)   \nGroups      0.035129 0.011710     3    20  0.8981 0.459421   \nTime        0.143141 0.143141     1    20 10.9792 0.003467 **\nGroups:Time 0.037216 0.012405     3    20  0.9515 0.434661   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nLa différence entre les deux modèles est très faible ce qui s’explique par le fait qu’il n’y a que deux mesures différentes par rat.\nOn peut ajouter des covariables dans le modèle (les autres paramètres biochimiques)\n\nLinModE&lt;-lmer(NEFA~Time*Groups+\n                BW+Cholesterol+Insulinemia+TG+(1|Rats),data=df)\nanova(LinModE)\n\nType III Analysis of Variance Table with Satterthwaite's method\n              Sum Sq  Mean Sq NumDF  DenDF F value  Pr(&gt;F)  \nTime        0.003758 0.003758     1 30.909  0.3027 0.58616  \nGroups      0.012932 0.004311     3 21.948  0.3472 0.79152  \nBW          0.002444 0.002444     1 21.046  0.1968 0.66184  \nCholesterol 0.063661 0.063661     1 30.773  5.1269 0.03075 *\nInsulinemia 0.000024 0.000024     1 34.629  0.0019 0.96530  \nTG          0.002964 0.002964     1 34.009  0.2387 0.62826  \nTime:Groups 0.030426 0.010142     3 20.713  0.8168 0.49920  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nSi on veut un modèle plus parcimonieux (on ne garde que les variables significatives), alors on utilise la fonction step :\n\nstep(LinModE)\n\nBackward reduced random-effect table:\n\n           Eliminated npar logLik    AIC       LRT Df Pr(&gt;Chisq)\n&lt;none&gt;                  14 6.8252 14.350                        \n(1 | Rats)          1   13 6.8219 12.356 0.0065287  1     0.9356\n\nBackward reduced fixed-effect table:\n            Eliminated Df Sum of Sq     RSS     AIC F value  Pr(&gt;F)  \nInsulinemia          1  1  0.000017 0.45533 -201.58  0.0013 0.97110  \nBW                   2  1  0.002678 0.45801 -203.30  0.2176 0.64361  \nTG                   3  1  0.002849 0.46086 -205.00  0.2364 0.62963  \nTime:Groups          4  3  0.039239 0.50010 -207.08  1.1069 0.35795  \nGroups               5  3  0.023605 0.52370 -210.87  0.6608 0.58079  \nTime                 0  1  0.048804 0.57251 -208.59  4.1935 0.04644 *\nCholesterol          0  1  0.078402 0.60211 -206.17  6.7368 0.01271 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nModel found:\nNEFA ~ Time + Cholesterol"
  },
  {
    "objectID": "docs/lme.html#vérification-de-la-qualité-mathématique-du-modèle.",
    "href": "docs/lme.html#vérification-de-la-qualité-mathématique-du-modèle.",
    "title": "Modèles linéaires à effets mixtes",
    "section": "Vérification de la qualité (mathématique) du modèle.",
    "text": "Vérification de la qualité (mathématique) du modèle.\n\nNormalité et indépendance des résidus du modèle\nOn a supposé que les résidus \\(\\varepsilon_{ijk}\\) sont distribués normalement on peut le vérifier graphiquement\n\nqqnorm(residuals(LinModE),pch=20)\nqqline(residuals(LinModE),pch=20)\n\n\n\n\nou bien grâce au test de Shapiro-Wilk\n\nshapiro.test(residuals(modLin))\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(modLin)\nW = 0.97806, p-value = 0.8576\n\n\nOn peut donc considérer que les résidus sont normaux.\nPour vérifier l’indépendance on regarde si il existe un lien entre les valeurs prédites et les résidus :\n\nplot(residuals(LinModE),fitted(LinModE),pch=20)\n\n\n\n\nClairement il n’y pas de lien !\n\n\nNormalité des effets aléatoires\n\nqqnorm(ranef(LinModE)$Rats$`(Intercept)`)\nqqline(ranef(LinModE)$Rats$`(Intercept)`)\n\n\n\nshapiro.test(ranef(LinModE)$Rats$`(Intercept)`)\n\n\n    Shapiro-Wilk normality test\n\ndata:  ranef(LinModE)$Rats$`(Intercept)`\nW = 0.98058, p-value = 0.9064"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "EC Expérimentation expérimentale",
    "section": "",
    "text": "Ce cours s’adresse aux étudiants de VET5 et VET6.\nIl concerne les modèles à effets mixtes qui sont des modèles usuels en expérimentation animale.\nToutes les manipulations seront faites sur le logiciel R-studio disponible à l’adresse Posit.\n\nBibliographie :\n\nLinear Mixed-Effects Models Using R\nSite analyse-R\nDesign and Analysis of Experiments\nGeneralized linear mixed models. Modern concepts methods and applications"
  }
]